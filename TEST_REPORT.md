# テストレポート

## 概要

Shiori Editorプロジェクトには、主要なコンポーネントをカバーする包括的なユニットテストスイートが含まれています。

## テスト統計

- **総テスト数**: 89
- **成功**: 89 (100%)
- **失敗**: 0
- **スキップ**: 0

## テストファイル一覧

### 1. ErrorHandlerTest.kt (9テスト)

エラーハンドリングとログ出力機能のテスト：

- ログレベル（ERROR, WARN, INFO）の出力確認
- 例外付き/例外なしのログ出力
- `safeExecute`メソッドの成功/失敗ケース
- カスタムエラーハンドラーの動作
- 複数の例外タイプの処理

### 2. ParagraphFoldingManagerTest.kt (17テスト)

段落の折りたたみ/展開機能のテスト：

- 基本的な折りたたみ/展開操作
- Markdown見出しの階層に基づく折りたたみ
- リスト項目（順序付き/順序なし）の折りたたみ
- 引用ブロックの折りたたみ
- 境界値テスト（インデックス範囲外）
- 折りたたみ状態の管理（`isFolded`, `clearAllFolding`, `getFoldedParagraphs`）
- 複数回の折りたたみ/展開操作

### 3. ProgrammingLanguageSupportTest.kt (17テスト)

プログラミング言語のシンタックスハイライト機能のテスト：

- 言語切り替え（Java, Go, C++, Haskell, Markdown, Plain Text）
- Java構文のハイライト（キーワード、文字列、コメント、数値）
- Go構文のハイライト（キーワード、バッククォート文字列）
- C++構文のハイライト（キーワード、プリプロセッサディレクティブ）
- Haskell構文のハイライト（キーワード）
- ダークモード/ライトモードの切り替え
- 空文字列と複数行コードの処理

### 4. MarkdownHighlighterTest.kt (22テスト)

Markdown構文のハイライト機能のテスト：

- 見出しレベル（H1〜H6）のハイライト
- テキストスタイル（太字、斜体、取り消し線）
- インラインコードとコードブロック
- 引用、リンク、画像
- リスト（順序付き/順序なし）
- 水平線
- ダークモード/ライトモードでの表示
- 複雑なMarkdownドキュメントの処理
- ネストされた構文の処理

### 5. ThemeManagerTest.kt (5テスト)

テーマ管理機能のテスト：

- 初期状態の確認（ライトモード）
- テーマの切り替え（ライト ⇔ ダーク）
- 複数回のトグル操作
- 複数のインスタンスの独立性

### 6. TextEditorUtilsTest.kt (19テスト)

テキスト編集ユーティリティ関数のテスト：

- `applyInlineWrap`：選択範囲のテキストを指定マーカーで囲む
  - 選択範囲あり/なし
  - 空文字列の処理
  - 異なるマーカー（`**`, `*`, `` ` ``, `~~`等）
  - 日本語テキストの処理
  - 改行を含むテキストの処理
  - カーソル位置の計算
- `getDefaultInitialText`：初期テキストの内容確認
- `confirmSaveIfModified`：保存確認ダイアログのロジック

## テスト実行方法

```bash
# すべてのテストを実行
./gradlew test

# 特定のテストクラスを実行
./gradlew test --tests "com.texteditor.ErrorHandlerTest"

# テストレポートの表示
open build/reports/tests/test/index.html
```

## 継続的インテグレーション

テストは以下のタイミングで自動実行されます：

1. **プルリクエスト時**: GitHub Actionsによる自動テスト
2. **コミット前**: pre-commitフック（`.githooks/pre-commit`を有効化している場合）

## テストカバレッジ向上のための今後の課題

現在のテストスイートは主要なロジックをカバーしていますが、以下の領域でさらなる改善が可能です：

- **UI関連のテスト**: Compose UIコンポーネントの統合テスト
- **ファイルI/O**: ファイル読み込み/保存機能のテスト（現在は実装の都合上スキップ）
- **統合テスト**: 複数コンポーネント間の連携テスト
- **パフォーマンステスト**: 大規模ファイルの処理速度測定

## 参考情報

- テストフレームワーク: JUnit 5 (Jupiter) + Kotlin Test
- アサーションライブラリ: kotlin.test
- ビルドツール: Gradle 8.5+

---

最終更新: 2025-10-30
